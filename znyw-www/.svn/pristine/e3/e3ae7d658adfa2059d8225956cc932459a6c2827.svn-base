define("p.all",function(a,b,c){var d=util.getQueryObject(),e=($("a.go_btn1"),{getLastSendVerifyCodeInfo:function(a){$.ajax({url:"/getLastSendVerifyCodeInfo",data:{},method:"get",error:function(){},success:function(b){a&&a(b)}})},sendVerifyCode:function(a,b,c,d){$.ajax({url:"/sendVerifyCode",data:{mobile:a,img_code:b,type:c},method:"get",error:function(){},success:function(a){d&&d(a)}})},loginsendVerifyCode:function(a,b){$.ajax({url:"/loginsendVerifyCode",data:{mobile:a},method:"get",error:function(){},success:function(a){b&&b(a)}})},sendBindSmsAuth:function(a,b,c,d){void 0==b&&(b=""),void 0==c&&(c=""),$.ajax({url:"/sendBindSmsAuth",data:{mobile:a,qq_key:b,union_id:c},method:"get",error:function(){},success:function(a){d&&d(a)}})},sendVerifyCodeBySID:function(a){$.ajax({url:"/sendVerifyCodeBySID",data:{},method:"post",error:function(){},success:function(b){a&&a(b)}})},loginsendVerifyCodeBySID:function(a){$.ajax({url:"/loginsendVerifyCodeBySID",data:{},method:"get",error:function(){},success:function(b){a&&a(b)}})},initSendVerifyCodeButton:function(a,b){var c=this,d={button:"",key:"",union_id:"",input:"",normalText:"发送验证码",onValidateError:function(){},onClickButton:function(){},onSending:function(){},afterSend:function(){},beforeSend:function(){return!0}};$.extend(d,a);var e=$(d.button),f=null,g=$(d.input.ipt_mobile),h=$(d.input.ipt_img_code),i=$(d.input.type),j=$(d.key),k=$(d.union_id),l={init:function(){var a=!1;c.getLastSendVerifyCodeInfo(function(m){function n(){e.unbind("click"),m.moblie&&g.val(m.moblie),f=setInterval(function(){var a=(new Date).getTime(),b=a+r,c=s-(b-t);if(0>=c)return clearInterval(f),void l.init();var d=parseInt(c/1e3);e.addClass("sendding"),e.text(d+"S")},1e3)}function o(){m.moblie&&g.val(m.moblie),e.removeClass("sendding"),e.text(d.normalText),e.unbind("click").click(function(){if(d.onClickButton(),0!=d.beforeSend()){if(util.checkEmpty(g.val())){var f=new ValidateNotice({message:"手机号码不能为空",location:"inner-right",element:g,considerScroll:!1,ttl:3e3});return void f.show()}if(util.checkEmpty(h.val())){var f=new ValidateNotice({message:"图形验证码不能为空",location:"inner-right",element:h,considerScroll:!1,ttl:3e3});return void f.show()}if(!util.isMobile(g.val())){var f=new ValidateNotice({message:"手机号码格式错误",location:"inner-right",element:g,considerScroll:!1,ttl:3e3});return void f.show()}a||(a=!0,setTimeout(function(){a=!1},2e3),"reg"==b?$.ajax({url:"api/checkMobileExist",data:{mobile:$("[name='mobile']").val()},type:"get",success:function(a){1==a.data||(d.onSending(),c.sendVerifyCode(g.val(),h.val(),function(a){d.afterSend(a),0==a.code?n():e.text(d.normalText)}))},error:function(){}}):"login"==b?$.ajax({url:"api/checkMobileExist",data:{mobile:$("[name='mobile']").val()},type:"get",success:function(a){0==a.data||(d.onSending(),c.loginsendVerifyCode(g.val(),function(a){d.afterSend(a),0==a.code?n():e.text(d.normalText)}))},error:function(){}}):"bind"==b?(d.onSending(),c.sendBindSmsAuth(g.val(),j.val(),k.val(),function(a){d.afterSend(a),0==a.code?n():e.text(d.normalText)})):"settled"==b&&(d.onSending(),c.sendVerifyCode(g.val(),h.val(),i.val(),function(a){d.afterSend(a),0==a.code?n():e.text(d.normalText)})))}})}var p=(new Date).getTime(),q=m.now,r=q-p,s=m.limit,t=m.lastTime;-1>=t?o():q>t+s?o():n()})}};l.init()},initSendVerifyCodeButtonBySID:function(a){var b=this,c={button:"",normalText:"发送验证码",onValidateError:function(){},onClickButton:function(){},onSending:function(){},afterSend:function(){},beforeSend:function(){return!0}};$.extend(c,a);var d=$(c.button),e=null,f={init:function(){var a=!1;b.getLastSendVerifyCodeInfo(function(g){function h(){d.unbind("click"),e=setInterval(function(){var a=(new Date).getTime(),b=a+l,c=m-(b-n);if(0>=c)return clearInterval(e),void f.init();var g=parseInt(c/1e3);d.text(g+"秒")},1e3)}function i(){d.text(c.normalText),d.unbind("click").click(function(){c.onClickButton(),0!=c.beforeSend()&&(a||(a=!0,setTimeout(function(){a=!1},2e3),c.onSending(),b.sendVerifyCodeBySID(function(a){c.afterSend(a),0==a.code?h():d.text(c.normalText)})))})}var j=(new Date).getTime(),k=g.now,l=k-j,m=g.limit,n=g.lastTime;-1>=n?i():k>n+m?i():h()})}};f.init()},showTips:function(a,b,c){if("success"!=b){var d=new WebUI;d.showTips({message:a,type:b,callback:function(){c&&c()}})}},bldTips:function(a,b,c){{var d=new WebUI;d.showTips({message:a,callback:function(){c&&c()}})}},initSearcher:function(){var a=$("#global-btn-search"),b=$("#global-ipt-keyword");a.length<=0||(d.key&&b.val(d.key),a.click(function(){var a=b.val(),c=$(".chosen-single span").eq(0).text();if("找项目"==c)var d=util.Json2URL("/requestlist",{key:a});else if("找服务"==c)var d=util.Json2URL("/servicelist",{key:a});else if("找工程公司"==c)var d=util.Json2URL("/servicePartylist",{key:a});location.href=d}),b.keypress(function(b){13==b.keyCode&&a.trigger("click")}))},userTips:function(a,b,c){var d={type:b,msg:a,from:location.href};void 0!=c&&(d.from=c);var e="/user/tips";e=util.Json2URL(e,d),location.href=e},initRegion:function(){null==$.cookie("region")&&$.cookie("region","东莞市",_cookieOption),null==$.cookie("region_id")&&$.cookie("region_id","1656",_cookieOption);var a=$("#region_name").text();$.cookie("region")!=a&&$("#region_name").text($.cookie("region")),$(".top_div .area").delegate("#region_list a","click",function(){var a=$(this).attr("id"),b=$(this).text();$.ajax({url:"/setregionlist",data:{region_id:a},method:"get",success:function(c){0==c.code?(e.showTips("切换地区成功","success"),setTimeout(function(){$.cookie("region",b,_cookieOption),$.cookie("region_id",a,_cookieOption),window.location.reload()})):e.showTips(c.msg,"error")},error:function(){}})})}});c.exports=e});