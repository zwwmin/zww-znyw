(function(e){e.fn.imagefit=function(t){var n=e.extend({},e.fn.imagefit.defaults,t);var r=e("html");r.data("main",this);r.data("mode",n.mode);r.data("hor",n.halign);r.data("ver",n.valign);r.data("force",n.force);var i=r.data("main").width();var s=r.data("main").height();var o=0,u=0;var a=0;r.data("main").css("overflow","hidden");r.data("main").css("position","relative");r.data("main").find("img").each(function(){var t=e(this);t.css("position","absolute");var n=e(this).width();var f=e(this).height();var l=0;var c=0;var h=1;var p=[];++a;e("<img/>").attr("src",t.attr("src")).load(function(){p["w"]=this.width;p["h"]=this.height;h=p["w"]/p["h"];if(r.data("mode")=="outside"){if(i/s>n/f){if(r.data("force")===false&&(i>p["w"]||s>p["h"])){o=p["w"];u=p["h"];l=Math.round((s-u)/2);if(r.data("hor")=="left"){c=0}else if(r.data("hor")=="right"){c=c=Math.round((i-o)/2*2)}else{c=Math.round((i-o)/2)}}else{o=i;u=Math.round(o*f/n);l=-Math.abs(Math.round((u-s)/2))}if(r.data("ver")=="top"){t.css("top","0");t.css("left",c+"px")}else if(r.data("ver")=="bottom"){t.css("top",l*2+"px");t.css("left",c+"px")}else{t.css("top",l+"px");t.css("left",c+"px")}}else{if(r.data("force")===false&&(i>p["w"]||s>p["h"])){o=p["w"];u=p["h"];l=Math.round((s-u)/2);c=Math.round((i-o)/2)}else{u=s;o=Math.round(u*n/f);c=-Math.abs(Math.round((o-i)/2))}if(r.data("hor")=="left"){t.css("top",l+"px");t.css("left","0")}else if(r.data("hor")=="right"){t.css("left",c*2+"px");t.css("top",l+"px")}else{t.css("left",c+"px");t.css("top",l+"px")}}t.width(o);t.height(u);t.css("width",o);t.css("height",u)}else if(r.data("mode")=="inside"){if(i/s>n/f){if(r.data("force")===false&&i>p["w"]&&s>p["h"]){o=p["w"];u=p["h"];l=Math.round((s-u)/2);c=Math.round((i-o)/2)}else{u=s;o=Math.round(u*n/f);c=Math.round((i-o)/2)}t.css("left",c+"px");t.css("top",l+"px");if(r.data("hor")=="left"){t.css("left","0")}if(r.data("ver")=="top"){t.css("top","0")}if(r.data("hor")=="right"){t.css("left",c*2+"px")}if(r.data("ver")=="bottom"){t.css("top",l*2+"px")}}else{if(r.data("force")===false&&i>p["w"]&&s>p["h"]){o=p["w"];u=p["h"];l=Math.round((s-u)/2);c=Math.round((i-o)/2)}else{o=i;u=Math.round(o*f/n);l=Math.round((s-u)/2)}t.css("left",c+"px");t.css("top",l+"px");if(r.data("hor")=="left"){t.css("left","0")}if(r.data("ver")=="top"){t.css("top","0")}if(r.data("hor")=="right"){t.css("left",c*2+"px")}if(r.data("ver")=="bottom"){t.css("top",l*2+"px")}}t.width(o);t.height(u);t.css("width",o);t.css("height",u)}else{}})});console.log("imageFit found "+a+" images.")};e.fn.imagefit.defaults={mode:"outside",halign:"center",valign:"middle",force:true}})(jQuery)